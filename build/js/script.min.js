"use strict";function tableGenerator(e,a,l,t,n,o,r,i){var p="",c=0,s="",d="",b="",m="",v="",u="",$="";$=(u=(v=(m=(b=i?(s='"<style>.PIPTABLEGEN td {border-color:#'+t+";background:#"+l+";height:"+o+"px;width:"+n+"px;vertical-align:middle;text-align: center}</style>",d='<table class="PIPTABLEGEN" cellpadding="+""10""+" border="+""1""+" bordercolor="+""#'+t+'""+" rules="+""all""+">','</table>"'):(s="<style>.PIPTABLEGEN td {border-color:#"+t+";background:#"+l+";height:"+o+"px;width:"+n+"px;vertical-align:middle;text-align: center}</style>",d='<table class="PIPTABLEGEN" cellpadding="10" border="1" bordercolor="#'+t+'" rules="all">',"</table>"),"<tr>"),"</tr>"),"<td>"),"</td>"),p+=s,p+=d;for(var f=0;f<e;f++){p+=m;for(var g=0;g<a;g++)c++,p+=u,"numbering"==r&&(p+=c),p+=$;p+=v}return p+=b}function checkingValues(e,a,l,t){var n=0;if(!1===isNaN(e)&&1===Math.sign(e)?($("#errorCanW").empty(),n++):$("#errorCanW").empty().append("Введите положительное число."),!1===isNaN(a)&&1===Math.sign(a)?($("#errorCanH").empty(),n++):$("#errorCanH").empty().append("Введите положительное число."),!1===isNaN(l)&&1===Math.sign(l)?($("#errorCellW").empty(),n++):$("#errorCellW").empty().append("Введите положительное число."),!1===isNaN(t)&&1===Math.sign(t)?($("#errorCellH").empty(),n++):$("#errorCellH").empty().append("Введите положительное число."),+l<=+e&&+t<=+a&&4==n)return $(".settings__error").empty(),!0;4==n&&($(".settings__error").empty().append("Холст меньше ячейки."),$(".pipTableGen__build-wrap").empty())}var tableCode,planfixformula;function tableResult(){var e,a,l,t,n,o,r,i,p,c,s,d,b,m,v,u,f;if(dataСleaning(),a=$("#canvas-size-1").val(),e=$("#canvas-size-2").val(),t=$("#cell-size-1").val(),l=$("#cell-size-2").val(),n=$("#cell-color").val(),o=$("#border-color").val(),r=$("#cellContentsOption").val(),i=$("#canvas-name-1").val(),p=$("#canvas-name-2").val(),c=$("#cell-name-1").val(),s=$("#cell-name-2").val(),d=$("#message1").val(),b=$("#message2").val(),f=+e<=+a?+l<=+t?(v=Math.floor(a/t),m=Math.floor(e/l),u=+t,+l):(v=Math.floor(a/l),m=Math.floor(e/t),u=+l,+t):+l<=+t?(v=Math.floor(a/l),m=Math.floor(e/t),u=+l,+t):(v=Math.floor(a/t),m=Math.floor(e/l),u=+t,+l),checkingValues(a,e,t,l)){$(".pipTableGen__col").empty().append(v),$(".pipTableGen__row").empty().append(m),$(".pipTableGen__amount").empty().append(m*v),tableCode=tableGenerator(m,v,n,o,u,f,r,!1),$(".pipTableGen__build-wrap").empty().append(tableCode),$(".pipTableGen__build-wrap").css("min-width",v*u+"px").css("min-height",m*f+"px"),$(".pipTableGen__copy-btn").removeAttr("disabled");var g=byteLength(planfixformula=planfixTablesGen(m,v,n,o,u,f,r,!0,i,p,c,s,d,b)),h="";h=1<g/1e9?(g=(g/1e9).toFixed(1),"Гб"):1<g/1e6?(g=(g/1e6).toFixed(1),"Мб"):1<g/1e3?(g=(g/1e3).toFixed(1),"Кб"):"Байт",$("#fileSize").empty().append(g+" "+h)}}function dataСleaning(){$(".pipTableGen__build-wrap").removeAttr("style"),$(".pipTableGen__copy-btn").attr("disabled",!0),planfixformula=tableCode="",$("#fileSize").empty()}function planfixTablesGen(e,a,l,t,n,o,r,i,p,c,s,d,b,m){for(var v="если(И("+s+">="+d+";"+p+">="+c+");",u="если(И("+s+">="+d+";"+c+">="+p+");",$="если(И("+d+">="+s+";"+p+">="+c+");",f="если(И("+d+">="+s+";"+c+">="+p+");",g='"'+b+'"',h='"'+m+'"))))',y="",_="",G=1;G<=e;G++)for(var w=1;w<=a;w++)g+=")",v+="если(И(ОКРУГЛВНИЗ(("+p+"/"+s+");0)="+w+";ОКРУГЛВНИЗ(("+c+"/"+d+");0)="+G+");",v+=y=tableGenerator(G,w,l,t,n,o,r,i),v+=";",u+="если(И(ОКРУГЛВНИЗ(("+c+"/"+s+");0)="+w+";ОКРУГЛВНИЗ(("+p+"/"+d+");0)="+G+");",u+=_=tableGenerator(w,G,l,t,n,o,r,i),u+=";",$+="если(И(ОКРУГЛВНИЗ(("+p+"/"+d+");0)="+w+";ОКРУГЛВНИЗ(("+d+"/"+p+");0)="+G+");",$+=y,$+=";",f+="если(И(ОКРУГЛВНИЗ(("+c+"/"+d+");0)="+w+";ОКРУГЛВНИЗ(("+p+"/"+s+");0)="+G+");",f+=_,f+=";";return v+(g+=";")+u+g+$+g+f+g+h}function byteLength(e){for(var a=e.length,l=e.length-1;0<=l;l--){var t=e.charCodeAt(l);127<t&&t<=2047?a++:2047<t&&t<=65535&&(a+=2),56320<=t&&t<=57343&&l--}return a}function writeFile(e,a){var l=a;void 0===a&&(l="");var t=document.createElement("a");t.href="data:text/plain;content-disposition=attachment;filename=file,"+l,t.download=e,t.style.display="none",t.id="download",document.body.appendChild(t),document.getElementById("download").click(),document.body.removeChild(t)}function tableResult1(){var e,a,l,t,n,o,r,i,p,c,s;dataСleaning(),a=$("#canvas-size-1").val(),e=$("#canvas-size-2").val(),t=$("#cell-size-1").val(),l=$("#cell-size-2").val(),n=$("#cell-color").val(),o=$("#border-color").val(),r=$("#cellContentsOption").val(),$("#canvas-name-1").val(),$("#canvas-name-2").val(),$("#cell-name-1").val(),$("#cell-name-2").val(),$("#message1").val(),$("#message2").val(),s=+e<=+a?+l<=+t?(p=Math.floor(a/t),i=Math.floor(e/l),c=+t,+l):(p=Math.floor(a/l),i=Math.floor(e/t),c=+l,+t):+l<=+t?(p=Math.floor(a/l),i=Math.floor(e/t),c=+l,+t):(p=Math.floor(a/t),i=Math.floor(e/l),c=+t,+l),checkingValues(a,e,t,l)&&($(".pipTableGen__col").empty().append(p),$(".pipTableGen__row").empty().append(i),$(".pipTableGen__amount").empty().append(i*p),tableCode=tableGenerator(i,p,n,o,c,s,r,!1),$(".pipTableGen__build-wrap").empty().append(tableCode),$(".pipTableGen__build-wrap").css("min-width",p*c+"px").css("min-height",i*s+"px"))}$(".pipTableGen__gen-btn").on("click",tableResult),$(".pipTableGen__copy-btn").on("click",function(){navigator.clipboard.writeText(planfixformula).then(function(){console.log("Async: Copying to clipboard was successful!")},function(e){console.error("Async: Could not copy text: ",e)})}),$(".pipTableGen__download-btn").on("click",function(){writeFile("123.txt",planfixformula)}),$(".pipTableGen__gen-btn-1").on("click",tableResult1),$("body.planfix").keypress(function(e){13==e.which&&tableResult1()}),$("body.page").keypress(function(e){13==e.which&&tableResult()}),document.addEventListener("DOMContentLoaded",function(){var e=window.location.search.replace("?","").split("&").reduce(function(e,a){var l=a.split("=");return e[decodeURIComponent(l[0])]=decodeURIComponent(l[1]),e},{});console.log(e),$("#canvas-size-1").val(e.canvasW),$("#canvas-size-2").val(e.canvasH),$("#cell-size-1").val(e.cellW),$("#cell-size-2").val(e.cellH)}),$(document).ready(function(){/MSIE 9/i.test(navigator.userAgent)||/MSIE 10/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)?document.documentElement.className+=" old-browser":/Edge\/\d./i.test(navigator.userAgent)&&(document.documentElement.className+=" edge-browser"),$(document).ready(function(){$("select").niceSelect()})});