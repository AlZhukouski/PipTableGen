"use strict";function tableGenerator(e,a,t,l,r,n,o,i){var p="",c=0,s="",d="",b="",u="",m="",g="",f="";f=(g=(m=(u=(b=i?(s='"<style>.PIPTABLEGEN td {border-color:#'+l+";background:#"+t+";height:"+n+"px;width:"+r+"px;vertical-align:middle;text-align: center}</style>",d='<table class="PIPTABLEGEN" cellpadding="+""10""+" border="+""1""+" bordercolor="+""#'+l+'""+" rules="+""all""+">','</table>"'):(s="<style>.PIPTABLEGEN td {border-color:#"+l+";background:#"+t+";height:"+n+"px;width:"+r+"px;vertical-align:middle;text-align: center}</style>",d='<table class="PIPTABLEGEN" cellpadding="10" border="1" bordercolor="#'+l+'" rules="all">',"</table>"),"<tr>"),"</tr>"),"<td>"),"</td>"),p+=s,p+=d;for(var $=0;$<e;$++){p+=u;for(var v=0;v<a;v++)c++,p+=g,"numbering"==o&&(p+=c),p+=f;p+=m}return p+=b}function checkingValues(e,a,t,l){var r=0;if(!1===isNaN(e)&&1===Math.sign(e)?($("#errorCanW").empty(),r++):$("#errorCanW").empty().append("Введите положительное число."),!1===isNaN(a)&&1===Math.sign(a)?($("#errorCanH").empty(),r++):$("#errorCanH").empty().append("Введите положительное число."),!1===isNaN(t)&&1===Math.sign(t)?($("#errorCellW").empty(),r++):$("#errorCellW").empty().append("Введите положительное число."),!1===isNaN(l)&&1===Math.sign(l)?($("#errorCellH").empty(),r++):$("#errorCellH").empty().append("Введите положительное число."),+t<=+e&&+l<=+a&&4==r)return $(".settings__error").empty(),!0;4==r&&($(".settings__error").empty().append("Холст меньше ячейки."),$(".pipTableGen__build-wrap").empty())}var tableCode,planfixformula;function tableResult(){var e,a,t,l,r,n,o,i,p,c,s,d,b,u,m,g,f;if(dataСleaning(),a=$("#canvas-size-1").val(),e=$("#canvas-size-2").val(),l=$("#cell-size-1").val(),t=$("#cell-size-2").val(),r=$("#cell-color").val(),n=$("#border-color").val(),o=$("#cellContentsOption").val(),i=$("#canvas-name-1").val(),p=$("#canvas-name-2").val(),c=$("#cell-name-1").val(),s=$("#cell-name-2").val(),d=$("#message1").val(),b=$("#message2").val(),f=+e<=+a?+t<=+l?(m=Math.floor(a/l),u=Math.floor(e/t),g=+l,+t):(m=Math.floor(a/t),u=Math.floor(e/l),g=+t,+l):+t<=+l?(m=Math.floor(a/t),u=Math.floor(e/l),g=+t,+l):(m=Math.floor(a/l),u=Math.floor(e/t),g=+l,+t),checkingValues(a,e,l,t)){$(".pipTableGen__col").empty().append(m),$(".pipTableGen__row").empty().append(u),$(".pipTableGen__amount").empty().append(u*m),tableCode=tableGenerator(u,m,r,n,g,f,o,!1),$(".pipTableGen__build-wrap").empty().append(tableCode),$(".pipTableGen__build-wrap").css("min-width",m*g+"px").css("min-height",u*f+"px"),$(".pipTableGen__copy-btn").removeAttr("disabled");var v=byteLength(planfixformula=planfixTablesGen(u,m,r,n,g,f,o,!0,i,p,c,s,d,b)),y="";y=1<v/1e9?(v=(v/1e9).toFixed(1),"Гб"):1<v/1e6?(v=(v/1e6).toFixed(1),"Мб"):1<v/1e3?(v=(v/1e3).toFixed(1),"Кб"):"Байт",$("#fileSize").empty().append(v+" "+y)}}function dataСleaning(){$(".pipTableGen__build-wrap").removeAttr("style"),$(".pipTableGen__copy-btn").attr("disabled",!0),planfixformula=tableCode="",$("#fileSize").empty()}function planfixTablesGen(e,a,t,l,r,n,o,i,p,c,s,d,b,u){for(var m="если(И("+s+">="+d+";"+p+">="+c+");",g="если(И("+s+">="+d+";"+c+">="+p+");",f="если(И("+d+">="+s+";"+p+">="+c+");",$="если(И("+d+">="+s+";"+c+">="+p+");",v='"'+b+'"',y='"'+u+'"))))',h="",_="",G=1;G<=e;G++)for(var x=1;x<=a;x++)v+=")",m+="если(И(ОКРУГЛВНИЗ(("+p+"/"+s+");0)="+x+";ОКРУГЛВНИЗ(("+c+"/"+d+");0)="+G+");",m+=h=tableGenerator(G,x,t,l,r,n,o,i),m+=";",g+="если(И(ОКРУГЛВНИЗ(("+c+"/"+s+");0)="+x+";ОКРУГЛВНИЗ(("+p+"/"+d+");0)="+G+");",g+=_=tableGenerator(x,G,t,l,r,n,o,i),g+=";",f+="если(И(ОКРУГЛВНИЗ(("+p+"/"+d+");0)="+x+";ОКРУГЛВНИЗ(("+d+"/"+p+");0)="+G+");",f+=h,f+=";",$+="если(И(ОКРУГЛВНИЗ(("+c+"/"+d+");0)="+x+";ОКРУГЛВНИЗ(("+p+"/"+s+");0)="+G+");",$+=_,$+=";";return m+(v+=";")+g+v+f+v+$+v+y}function byteLength(e){for(var a=e.length,t=e.length-1;0<=t;t--){var l=e.charCodeAt(t);127<l&&l<=2047?a++:2047<l&&l<=65535&&(a+=2),56320<=l&&l<=57343&&t--}return a}$(".pipTableGen__gen-btn").on("click",tableResult),$(".pipTableGen__copy-btn").on("click",function(){navigator.clipboard.writeText(planfixformula).then(function(){console.log("Async: Copying to clipboard was successful!")},function(e){console.error("Async: Could not copy text: ",e)})}),$(document).ready(function(){/MSIE 9/i.test(navigator.userAgent)||/MSIE 10/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)?document.documentElement.className+=" old-browser":/Edge\/\d./i.test(navigator.userAgent)&&(document.documentElement.className+=" edge-browser"),$(document).ready(function(){$("select").niceSelect()})});